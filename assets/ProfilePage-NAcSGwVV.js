import{d as T,g as a,l as v,j as B,o as w,c as k,b as t,t as b,k as M,f as n,v as A,_ as j,h as O,e as R,w as H}from"./index-B9vTfeto.js";import{I as C}from"./IconButton-CHNMKwbQ.js";import{F as J}from"./FormWrapper-CKm7w-vs.js";import W from"./ProfileEditPage-D1jkfc6U.js";import{R as y}from"./PhotoDragDrop-B-a394b-.js";import"./TextInput-Be5mo-wx.js";const h={key:0,class:"error-message"},q={class:"submit-notify"},z=T({__name:"ProfileNotifySet",props:{editNotify:{type:Boolean},notification:{}},emits:["submit","update:editNotify"],setup(F,{emit:U}){const d=F,V=U,f=a("0"),m=a("0"),s=a("0"),p=a("0"),u=a({comment:!1,follow:!1,favorite:!1,illust:!1});v(()=>{var l;return(l=d.notification[0])==null?void 0:l.comment},l=>{l!=null&&(f.value=String(l))},{immediate:!0}),v(()=>{var l;return(l=d.notification[0])==null?void 0:l.follow},l=>{l!=null&&(m.value=String(l))},{immediate:!0}),v(()=>{var l;return(l=d.notification[0])==null?void 0:l.favorite},l=>{l!=null&&(s.value=String(l))},{immediate:!0}),v(()=>{var l;return(l=d.notification[0])==null?void 0:l.illust},l=>{l!=null&&(p.value=String(l))},{immediate:!0}),v(f,l=>{var e;return u.value.comment=l!==((e=d.notification[0])==null?void 0:e.comment)}),v(m,l=>{var e;return u.value.follow=l!==((e=d.notification[0])==null?void 0:e.follow)}),v(s,l=>{var e;return u.value.favorite=l!==((e=d.notification[0])==null?void 0:e.favorite)}),v(p,l=>{var e;return u.value.illust=l!==((e=d.notification[0])==null?void 0:e.illust)});const g=a(""),c=B(),N=a(c.id),S=async()=>{const l=new FormData;u.value.comment&&l.append("comment",f.value||"0"),u.value.follow&&l.append("follow",m.value||"0"),u.value.favorite&&l.append("favorite",s.value||"0"),u.value.illust&&l.append("illust",p.value||"0");try{const e=await fetch(`https://yellowokapi2.sakura.ne.jp/Vue/api/NotificationEditAPI.php/${N.value}`,{method:"POST",body:l});if(!(e.headers.get("Content-Type")||"").includes("application/json"))throw new Error("サーバーからJSON形式の返答がありませんでした。");const I=await e.json();if(!e.ok)throw new Error(I.message||`HTTP ${e.status}`);alert("データが正常に送信されました"),V("submit"),V("update:editNotify",!1)}catch(e){console.error("更新失敗:",e),g.value="更新に失敗しました。もう一度お試しください。"}},_=()=>{V("update:editNotify",!1)};return(l,e)=>(w(),k("form",{onSubmit:A(S,["prevent"])},[e[8]||(e[8]=t("h1",{class:"notify-title"},"Notification",-1)),g.value?(w(),k("div",h,b(g.value),1)):M("",!0),e[9]||(e[9]=t("p",null,"コメント",-1)),n(y,{id:"onComment",name:"comment",value:"1",label:"通知する",modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=i=>f.value=i)},null,8,["modelValue"]),n(y,{id:"offComment",name:"comment",value:"0",label:"非通知",modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=i=>f.value=i)},null,8,["modelValue"]),e[10]||(e[10]=t("p",null,"フォロー",-1)),n(y,{id:"onFollow",name:"follow",value:"1",label:"通知する",modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=i=>m.value=i)},null,8,["modelValue"]),n(y,{id:"offFollow",name:"follow",value:"0",label:"非通知",modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=i=>m.value=i)},null,8,["modelValue"]),e[11]||(e[11]=t("p",null,"いいね",-1)),n(y,{id:"onFavorite",name:"favorite",value:"1",label:"通知する",modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=i=>s.value=i)},null,8,["modelValue"]),n(y,{id:"offFavorite",name:"favorite",value:"0",label:"非通知",modelValue:s.value,"onUpdate:modelValue":e[5]||(e[5]=i=>s.value=i)},null,8,["modelValue"]),e[12]||(e[12]=t("p",null,"投稿",-1)),n(y,{id:"onIllust",name:"illust",value:"1",label:"通知する",modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=i=>p.value=i)},null,8,["modelValue"]),n(y,{id:"offIllust",name:"illust",value:"0",label:"非通知",modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=i=>p.value=i)},null,8,["modelValue"]),t("div",q,[n(C,{label:"キャンセル",backgroundColor:"secondary",onClick:_}),n(C,{type:"submit",label:"保存する"})])],32))}}),G=j(z,[["__scopeId","data-v-87ecc64b"]]),K={key:0},L={key:0,class:"error-message"},Q={key:1,class:"profile-content"},X={class:"profile-item"},Y={class:"profile-item"},Z={class:"profile-body"},ee={class:"profile-item"},le={class:"profile-item"},oe={class:"profile-item"},te={class:"profile-item"},ae={class:"button-area"},ie={class:"profile-item"},ne={class:"button-area"},se={key:1},ue={key:2},re=T({__name:"ProfilePage",setup(F){const U=B(),d=a(U.id),V=a(""),f=a(""),m=a(""),s=a(""),p=a(""),u=a(""),g=a(""),c=a(!1),N=a(!1),S=a(""),_=a(""),l=a(""),e=a(""),i=a(!1),I=a([]),D=async()=>{if(!d.value){s.value="ユーザーIDが見つかりません。";return}c.value===!0&&(c.value=!1);try{const r=await fetch(`https://yellowokapi2.sakura.ne.jp/Vue/api/ProfileAllCatchAPI.php/${d.value}`);if(!r.ok)throw new Error("プロフィールの取得に失敗しました。");const o=await r.json();V.value=o.name||"未設定",f.value=o.body||"未設定",m.value=o.birthDate||"未設定",p.value=o.login_id||"未設定",u.value=o.password||"未設定",g.value=String(o.certificate18)||"未設定",S.value=String(o.n_comment)||"未設定",_.value=String(o.n_follow)||"未設定",l.value=String(o.n_favorite)||"未設定",e.value=String(o.n_illust)||"未設定",I.value.push({comment:S.value,follow:_.value,favorite:l.value,illust:e.value})}catch(r){console.error("プロフィールの取得エラー:",r),s.value="プロフィールの読み込み中にエラーが発生しました。"}};v(c,r=>{r===!1&&D()}),v(N,r=>{r===!1&&D()}),v([S,_,l,e],([r,o,P,E])=>{i.value=r!=="1"||o!=="1"||P!=="1"||E!=="1",I.value=[{comment:r,follow:o,favorite:P,illust:E}]},{immediate:!0}),O(D);const $=()=>{c.value=!0},x=()=>{N.value=!0};return(r,o)=>(w(),R(J,null,{default:H(()=>[!c.value&&!N.value?(w(),k("span",K,[o[9]||(o[9]=t("h1",{class:"profile-title"},"Profile",-1)),s.value?(w(),k("div",L,b(s.value),1)):(w(),k("div",Q,[t("div",X,[o[2]||(o[2]=t("label",null,"ユーザー名",-1)),t("p",null,b(V.value),1)]),t("div",Y,[o[3]||(o[3]=t("label",null,"自己紹介",-1)),t("p",Z,b(f.value),1)]),t("div",ee,[o[4]||(o[4]=t("label",null,"生年月日",-1)),t("p",null,b(m.value),1)]),t("div",le,[o[5]||(o[5]=t("label",null,"ログインID",-1)),t("p",null,b(p.value),1)]),t("div",oe,[o[6]||(o[6]=t("label",null,"パスワード",-1)),t("p",null,b(u.value?"●●●●●●":"未設定"),1)]),t("div",te,[o[7]||(o[7]=t("label",null,"年齢制限付きの画像",-1)),t("p",null,b(Number(g.value)?"表示する":"表示しない"),1)]),t("div",ae,[n(C,{label:"編集する",onClick:$})]),t("div",ie,[o[8]||(o[8]=t("label",null,"通知",-1)),t("p",null,b(i.value?"カスタム":"デフォルト"),1)])])),t("div",ne,[n(C,{label:"編集する",onClick:x})])])):c.value?(w(),k("span",se,[n(W,{userName:V.value,certificate18:g.value,password:u.value,body:f.value,birthDate:m.value,editProfile:c.value,"onUpdate:editProfile":o[0]||(o[0]=P=>c.value=P)},null,8,["userName","certificate18","password","body","birthDate","editProfile"])])):(w(),k("span",ue,[n(G,{editNotify:N.value,"onUpdate:editNotify":o[1]||(o[1]=P=>N.value=P),notification:I.value},null,8,["editNotify","notification"])]))]),_:1}))}}),be=j(re,[["__scopeId","data-v-000d7c15"]]);export{be as default};
