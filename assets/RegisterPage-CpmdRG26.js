import{d as g,g as d,h as y,o as m,c,b as s,m as u,v as b,f as p,k as w,u as k,s as I,_ as V}from"./index-lzizTrR5.js";import{T as v}from"./TextInput-DzyqH3TE.js";import{I as P}from"./IconButton-Bwx97DTe.js";const N={key:0},T={key:1,class:"container"},h={class:"register-card"},j={class:"wrapper"},x={class:"submit-register"},A=g({__name:"RegisterPage",setup(R){const t=k(),n=I().query.token,r=d(null);y(async()=>{if(console.log("取得したトークン:",n),!n){t.push("/invalid-token");return}try{(await(await fetch("https://yellowokapi2.sakura.ne.jp/Vue/api/VerifyTokenAPI.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:n})})).json()).valid?r.value=!0:t.push("/invalid-token")}catch(o){console.error("API通信エラー:",o),t.push("/invalid-token")}});const a=d(""),l=d(""),f=async()=>{console.log("登録:",{loginId:a.value,password:l.value});try{const e=await(await fetch("https://yellowokapi2.sakura.ne.jp/Vue/api/RegisterAPI.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({loginId:a.value,password:l.value})})).json();console.log("APIレスポンス:",e),e.success?(alert("登録完了!"),t.push("/register/complete")):alert(e.message||"登録失敗よ！もっとちゃんと入力しなさい！")}catch(o){console.error("登録API通信エラー:",o),alert("通信エラーよ！あとでやり直しなさい！")}};return(o,e)=>r.value===null?(m(),c("div",N,e[2]||(e[2]=[s("p",null,"トークン確認中…",-1)]))):r.value?(m(),c("div",T,[s("div",h,[s("div",j,[e[7]||(e[7]=s("h2",{class:"title"},"ようこそ！",-1)),e[8]||(e[8]=s("p",{class:"description"},[u(" メール確認ありがとうございます！"),s("br"),u(" 続けて、ログイン用のIDとパスワードを設定してください。"),s("br"),u(" この設定が終わると、登録が完了します。 ")],-1)),s("form",{onSubmit:b(f,["prevent"])},[e[3]||(e[3]=s("label",{for:"loginid"},"ログインID",-1)),p(v,{id:"loginid",className:"loginid",name:"loginid",modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=i=>a.value=i),required:""},null,8,["modelValue"]),e[4]||(e[4]=s("br",null,null,-1)),e[5]||(e[5]=s("label",{for:"password"},"パスワード",-1)),p(v,{id:"password",className:"password",name:"password",type:"password",modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=i=>l.value=i),required:""},null,8,["modelValue"]),e[6]||(e[6]=s("br",null,null,-1)),s("div",x,[p(P,{label:"登録",type:"submit",class:"submit-button"})])],32)])])])):w("",!0)}}),O=V(A,[["__scopeId","data-v-9e938efc"]]);export{O as default};
