import{d as f,u as y,g as u,h as I,l as g,i as S,o as p,c as d,x as k,C as A,b as r,v as b,_,f as v,s as x}from"./index-B9vTfeto.js";import{S as P,I as j}from"./ImageGallery-DcI1cGD2.js";import"./R18AccessButton-DNH2j6Du.js";const B=f({__name:"SearchField",setup(w){const h=y(),a=u(""),l=u([]);I(()=>{const s=localStorage.getItem("searchInput");s&&(a.value=s)}),g(a,s=>{localStorage.setItem("searchInput",s)}),S(()=>{localStorage.removeItem("searchInput")});const o=()=>{if(!a.value.trim())return;const s=a.value.split(/\s+/).map(c=>c.trim()).filter(c=>c.length>0);l.value=Array.from(new Set(s));const n=l.value.join(" ");a.value=n,h.push({path:"/search",query:{words:l.value.join(",")}})};return(s,n)=>(p(),d("form",{class:"search-field",onSubmit:b(o,["prevent"])},[k(r("input",{"onUpdate:modelValue":n[0]||(n[0]=c=>a.value=c),type:"search",placeholder:"キーワードで検索",class:"search-input"},null,512),[[A,a.value]]),n[1]||(n[1]=r("button",{type:"submit",class:"search-button"},[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M21 21l-4.35-4.35M11 19a8 8 0 100-16 8 8 0 000 16z"})]),r("span",null,"検索")],-1))],32))}}),C=_(B,[["__scopeId","data-v-dab1df6e"]]),T={class:"search-page"},M={class:"search-header"},V={class:"search-results"},$={key:0},q={key:1,class:"no-results"},R=f({__name:"SearchPage",setup(w){const h=x(),a=u(""),l=u(""),o=u([]),s=u(""),n=async i=>{a.value=decodeURIComponent(i);try{const e=await(await fetch(`https://yellowokapi2.sakura.ne.jp/Vue/api/TagCatchAPI.php?tag=${a.value}`)).json();console.log("APIレスポンス(tag):",e),Array.isArray(e)?o.value=e.map(m=>({...m,showProfile:!0})):(console.error("APIから配列が返っていません:",e),o.value=[]),e.length>0&&e[0].tags&&(s.value=String(e[0].tags))}catch(t){console.error("Error fetching data (tag):",t)}},c=async i=>{l.value=decodeURIComponent(i);try{const e=await(await fetch(`https://yellowokapi2.sakura.ne.jp/Vue/api/Illust_tagsSearchAPI.php?words=${l.value}`)).json();Array.isArray(e)?o.value=e.map(m=>({...m,showProfile:!0})):(console.error("APIから配列が返っていません:",e),o.value=[]),e.length>0&&(s.value=l.value)}catch(t){console.error("Error fetching data (words):",t)}};return g(()=>h.query,i=>{const t=i.tag||"",e=i.words||"";t.trim()&&!e.trim()?n(t):e.trim()&&!t.trim()?c(e):console.error("タグかワードのどちらか一方を指定してください")},{deep:!0,immediate:!0}),(i,t)=>(p(),d("div",T,[r("header",M,[v(C)]),r("main",V,[o.value.length>0?(p(),d("div",$,[v(P,{title:`${s.value} の検索結果`,subtitle:`${o.value.length}件見つかりました`},null,8,["title","subtitle"]),v(j,{posts:o.value},null,8,["posts"])])):(p(),d("div",q,t[0]||(t[0]=[r("p",null,"該当する検索結果はありません。",-1),r("span",null,"別のキーワードで試してみてください。",-1)])))])]))}}),F=_(R,[["__scopeId","data-v-454779fa"]]);export{F as default};
